<!-- BEGIN_TF_DOCS -->
<!-- Code generated by terraform-docs. DO NOT EDIT. -->
# Azure Relay Namespace with Subresources Example

```hcl
terraform {
  required_version = "~> 1.5"

  required_providers {
    azurerm = {
      source  = "hashicorp/azurerm"
      version = "~> 4.21"
    }
    random = {
      source  = "hashicorp/random"
      version = "~> 3.5"
    }
  }
}

provider "azurerm" {
  features {}
}


## Section to provide a random Azure region for the resource group
# This allows us to randomize the region for the resource group.
module "regions" {
  source  = "Azure/avm-utl-regions/azurerm"
  version = "0.1.0"
}

# This allows us to randomize the region for the resource group.
resource "random_integer" "region_index" {
  max = length(module.regions.regions) - 1
  min = 0
}
## End of section to provide a random Azure region for the resource group

# This ensures we have unique CAF compliant names for our resources.
module "naming" {
  source  = "Azure/naming/azurerm"
  version = "0.3.0"
}

# This is required for resource modules
resource "azurerm_resource_group" "this" {
  location = module.regions.regions[random_integer.region_index.result].name
  name     = module.naming.resource_group.name_unique
}

# This is the module call for the Relay namespace
module "relay_namespace" {
  source = "../../"

  location              = azurerm_resource_group.this.location
  name                  = module.naming.relay_namespace.name_unique
  resource_group_id     = azurerm_resource_group.this.id
  enable_telemetry      = var.enable_telemetry
  public_network_access = "Enabled"
  sku = {
    name = "Standard"
    tier = "Standard"
  }
}

# Authorization Rule
module "auth_rule" {
  source = "../../modules/authorization-rule"

  name               = "RootManageSharedAccessKey"
  relay_namespace_id = module.relay_namespace.resource_id
  rights             = ["Listen", "Send", "Manage"]
}

# Hybrid Connection
module "hybrid_connection" {
  source = "../../modules/hybrid-connection"

  name                          = "my-hybrid-connection"
  relay_namespace_id            = module.relay_namespace.resource_id
  requires_client_authorization = true
  user_metadata                 = "Example hybrid connection"
}

# WCF Relay
module "wcf_relay" {
  source = "../../modules/wcf-relay"

  name                          = "my-wcf-relay"
  relay_namespace_id            = module.relay_namespace.resource_id
  relay_type                    = "NetTcp"
  requires_client_authorization = true
  requires_transport_security   = true
  user_metadata                 = "Example WCF relay"
}

# Network Rule Set
module "network_rule_set" {
  source = "../../modules/network-rule-set"

  relay_namespace_id = module.relay_namespace.resource_id
  default_action     = "Deny"
  ip_rules = [
    {
      ipMask = "10.0.0.0/24"
      action = "Allow"
    }
  ]
  public_network_access          = "Enabled"
  trusted_service_access_enabled = true
}
```

<!-- markdownlint-disable MD033 -->
## Requirements

The following requirements are needed by this module:

- <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) (~> 1.5)

- <a name="requirement_azurerm"></a> [azurerm](#requirement\_azurerm) (~> 4.21)

- <a name="requirement_random"></a> [random](#requirement\_random) (~> 3.5)

## Resources

The following resources are used by this module:

- [azurerm_resource_group.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/resource_group) (resource)
- [random_integer.region_index](https://registry.terraform.io/providers/hashicorp/random/latest/docs/resources/integer) (resource)

<!-- markdownlint-disable MD013 -->
## Required Inputs

No required inputs.

## Optional Inputs

The following input variables are optional (have default values):

### <a name="input_enable_telemetry"></a> [enable\_telemetry](#input\_enable\_telemetry)

Description: This variable controls whether or not telemetry is enabled for the module.  
For more information see <https://aka.ms/avm/telemetryinfo>.  
If it is set to false, then no telemetry will be collected.

Type: `bool`

Default: `true`

## Outputs

No outputs.

## Modules

The following Modules are called:

### <a name="module_auth_rule"></a> [auth\_rule](#module\_auth\_rule)

Source: ../../modules/authorization-rule

Version:

### <a name="module_hybrid_connection"></a> [hybrid\_connection](#module\_hybrid\_connection)

Source: ../../modules/hybrid-connection

Version:

### <a name="module_naming"></a> [naming](#module\_naming)

Source: Azure/naming/azurerm

Version: 0.3.0

### <a name="module_network_rule_set"></a> [network\_rule\_set](#module\_network\_rule\_set)

Source: ../../modules/network-rule-set

Version:

### <a name="module_regions"></a> [regions](#module\_regions)

Source: Azure/avm-utl-regions/azurerm

Version: 0.1.0

### <a name="module_relay_namespace"></a> [relay\_namespace](#module\_relay\_namespace)

Source: ../../

Version:

### <a name="module_wcf_relay"></a> [wcf\_relay](#module\_wcf\_relay)

Source: ../../modules/wcf-relay

Version:

# Footer content
<!-- END_TF_DOCS -->